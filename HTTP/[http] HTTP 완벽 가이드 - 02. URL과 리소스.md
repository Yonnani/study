# HTTP 완벽 가이드

## 2장. URL과 리소스

- URL(Uniform Resource Locator)은 인터넷의 리소스를 가리키는 표준이름

### 2.1 인터넷의 리소스 탐색하기

- URL은 통합 자원 식별자(Uniform Resource Identifier) 혹은 URI라고 불리는 더 일반화된 부류의 부분집합임
- URI는 두 가지 주요 부분집합인, URL과 URN으로 구성된 종합적인 개념
- `http://www.joes-hardware.com/seasonal/index-fall.html`
  - URL의 첫 부분인 `http`는 URL의 스킴
    - 스킴은 웹 클라이언트가 리소스에 어떻게 접근하는지 알려줌
    - 이 경우는, URL이 HTTP 프로토콜을 사용함
  - URL의 두 번째 부분인 `www.joes-hardware.com`은 서버의 위치
    - 웹 클라이언트가 리소스가 어디에 호스팅 되어 있는지 알려줌
  - URL의 세 번째 부분인 `/seasonal/index-fall.html`은 리소스의 경로
    - 경로는 서버에 존재하는 로컬 리소스들 중에서 요청받은 리소스가 무엇인지 알려줌
- URL은 다른 가용한 프로토콜을 사용할 수도 있음
  -  `mailto:president@whitehouse.gov` : 이메일 주소를 가리킴
  - `ftp://ftp.lots-o-books.com/pub/complete-price-list.xls` : FTP(File Transfer Protocol) 서버에 올라가 있는 파일을 가리킴
  - `rtsp://www.joes-hardware.com:554/interview/cto_video` : 스트리밍을 제공하기 위해 비디오 서버에 호스팅하고 있는 영화를 가리킴
- URL을 사용하면 리소스를 일관된 방식으로 지칭할 수 있음
  - `스킴://서버위치/경로` 구조임

#### 2.1.1 URL이 있기 전 암흑의 시대

- URL은 애플리케이션이 리소스에 접근할 수 있는 방법을 제공함

### 2.2 URL 문법

- 인터넷의 리소스들은 다른 스킴(ex. HTTP, FTP, SMTP)을 통해 접근할 수 있으며, URL 문법은 스킴에 따라서 달라짐
- 대부분의 URL 스킴의 문법은 일반적으로 9개 부분으로 나뉨
  - `<스킴>://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<프레그먼트>`

#### 2.2.1 스킴: 사용할 프로토콜

- 스킴 컴포넌트는 알파벳으로 시작
- URL의 나머지 부분들과 첫 번째 `:` 문자로 구분함
- 대소문자 구분하지 않음

#### 2.2.2 호스트와 포트

- 호스트 컴포넌트는 접근하려고 하는 리소스를 가지고 있는 인터넷상의 호스트 장비를 가리킴
- 호스트 명이나 IP 주소로 제공함
- 포트 컴포넌트는 서버가 열어놓은 네트워크 포트를 가리킴
  - 내부적으로 TCP 프로토콜을 사용하는 HTTP는 기본 포트로 80을 사용함

#### 2.2.3 사용자 이름과 비밀번호

- `ftp://ftp.prep.ai.mit.edu/pub/gnu`
- `ftp://anonymous@ftp.prep.ai.mit.edu/pub/gnu`
- `ftp://anonymous:my_passwd@ftp.prep.ai.mit.edu/pub/gnu`
- `http://joe:joespasswd@www.joes-hardware.com/sales_info.txt`

#### 2.2.4 경로

- URL의 경로 컴포넌트는 리소스가 서버의 어디에 있는지 알려줌

#### 2.2.5 파라미터

- URL의 파라미터 컴포넌트는, 애플리케이션이 서버에 정확한 요청을 하기 위해 필요한 입력 파라미터를 받는데 사용함
- 이름/값 쌍의 리스트로 URL 나머지 부분들로부터 `;` 문자로 구분하여 URL에 기술함
- ex. `ftp://prep.ai.mit.edu/pub/gnu;type=d`
  - 이름은 `type`, 값은 `d`인 한 개의 파라미터를 전달함
- HTTP URL에서의 경로 컴포넌트는 경로조각으로 나눌수 있고, 각 조각은 자체 파라미터를 가질 수 있음
  - ex. `http://www.joes-hardware.com/hammers;sale=false/index.html;graphics=true`

#### 2.2.6 질의 문자열

- `http://www.joes-hardware.com/inventory-check.cgi?item=12731`
  - 물음표 우측에 있는 값 : 질의 컴포넌트
- URL의 질의 컴포넌트는 게이트웨이를 가리키는 URL의 경로 컴포넌트와 함께 전달하고 있음
- 편의상 많은 게이트웨이가 `&`로 나뉜 `이름=값` 쌍 형식의 질의 문자열을 원함

#### 2.2.7 프래그먼트

- HTML 같은 리소스 형식들은 본래의 수준보다 더 작게 나뉠 수 있음
- 리소스의 특정 부분을 가리킬 수 있도록  URL은 리소스 내의 조각을 가리킬 수 있는 프래그먼트 컴포넌트를 제공함
- 프래그먼트는 URL의 오른쪽에 `#` 문자에 이어서 옴
  - ex. `http://www.joes-hardware.com/tools.html#drills`
    - `drills`라는 프래그먼트는 `/tools.html` 웹페이지의 일부를 가리킴
- 클라이언트는 서버에 프래그먼트를 전달하지 않고 브라우저가 전체를 받은 후, 프래그먼트를 사용하여 해당하는 부분을 보여줌

### 2.3 단축 URL

#### 2.3.1 상대 URL

- 상대 URL은 URL을 짧게 표기하는 방식
- ex. `...<a href="./hammers.html">hammers</a>...`
- 상대 URL을 사용하면 리소스 집합을 쉽게 변경할 수 있음
- **기저 URL**
  - 변환 과정의 첫 단계는 기저 URL을 찾는 것임
  - 찾는 방법
    - 리소스에서 명시적으로 제공
    - 리소스를 포함하고 있는 기저 URL
      - 해당 리소스의 URL을 기저 URL로 쓸 수 있음
    - 기저 URL이 없는 경우
      - 보통은 절대 URL 만으로 이루어져 있다는 뜻이지만 불완전하거나 깨진 URL일 수도 있음
- **상대 참조 해석하기**
  - URL 분해하기

#### 2.3.2 URL 확장

- **호스트 명 확장**
- **히스토리 확장**

### 2.4 안전하지 않은 문자

- 안전한 전송 : 정보가 유실될 위험 없이 URL을 전송할 수 있다는 것
- SMTP(Simple Mail Transfer Protocol)은 특정 문자를 제거할 수도 있는 전송 방식을 사용함
- 그래서 문자가 제거되는 일을 피하고자 URL은 상대적으로 작고 일반적으로 안전한 알파벳 문자만 포함하도록 허락함
- 이스케이프라는 기능을 추가하여, 안전하지 안흥ㄴ 문자를 안전한 문자로 인코딩할 수 있게 함

#### 2.4.1 URL 문자 집합

- URL 설계자들은 URL에 이스케이프 문자열을 쓸 수 있게 설계함

#### 2.4.2 인코딩 체계

- 인코딩은 안전하지 않은 문자를 `%` 기호로 시작해, ASCII 코드로 표현되는 두 개의 16진수 숫자로 이루어진 '이스케이프' 문자로 바꿈

#### 2.4.3 문자 제한

- 예약된 문자를 본래의 목적이 아닌 다른 용도로 사용하려면, 반드시 인코딩 해야함
  - % / . .. # ? ; : $ + @ & = { } | \ ~ [] ` < > " 0x00-0x1F 0x7F > 0x7F

#### 2.4.4 좀 더 알아보기

- 안전하지 않은 모든 문자를 인코딩하기만 하면, 애플리케이션 간에 공유할 수 있는 URL의 원형을 유지할 수 있음

### 2.5. 스킴의 바다

### 2.6 미래

- URL은 인터넷 프로토콜 간에 공유할 수 있는 일관된 작명 규칙을 제공함
- 하지만 리소스 위치가 변경되면 찾을 수 없기 때문에 완벽하지 않음
- 그래서 인터넷 기술 태스크 포스(Internet Engineering Task Force, IETF)는 URN(Uniform Resource Names)이라는 새로운 표준 작업에 착수함
- 지속 통합 자원 지시자(Persistent uniform resource locator, PURL)을 사용하면 URL로 URN의 기능을 제공할 수 있음
- PURL은 리소스의 실제 URL 목록을 관리하고 추적하는 리소스 위치 중개 서버를 두고, 해당 리소스를 우회적으로 제공함

#### 2.6.1 지금이 아니면, 언제?

- URN으로 전환하기 위한 모든 것이 준비되려면 오래 걸릴 예정이므로, URL은 당분간 계속 사용될 것임

### 2.7 추가 정보

